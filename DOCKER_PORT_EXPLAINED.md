# Docker端口配置说明

## 当前配置

在我们的Docker设置中，端口配置如下：

1. **Nginx (Frontend Container)**:
   - 在容器内部，Nginx监听80端口（这是标准的HTTP端口）
   - 通过Docker端口映射，将主机的3000端口映射到容器的80端口
   - 这意味着：当您访问 http://your-server-ip:3000 时，请求会被转发到容器内的Nginx 80端口

2. **Flask (Backend Container)**:
   - 在容器内部，Flask应用监听5000端口
   - 通过Docker端口映射，将主机的5000端口映射到容器的5000端口
   - 这意味着：当您访问 http://your-server-ip:5000 时，请求会直接到达Flask应用

## 为什么要这样配置？

1. **标准化容器内部端口**:
   - 在容器内部使用标准端口（如Nginx使用80端口）是最佳实践
   - 这使得容器配置与标准配置保持一致，无需在容器内部做特殊修改

2. **灵活的主机端口映射**:
   - 通过Docker Compose的端口映射，我们可以灵活选择主机上使用的端口
   - 这允许我们在不修改容器内部配置的情况下，适应不同的部署环境

## Dockerfile中的EXPOSE指令

`Dockerfile`中的`EXPOSE 80`指令只是一个声明，告诉Docker该容器打算使用哪个端口。它有以下几个作用：

1. 作为文档，告诉使用者该容器服务监听哪个端口
2. 在使用`docker run -P`时（自动端口映射），Docker会使用EXPOSE定义的端口
3. 某些网络模式下可能会用到这个信息

但EXPOSE本身不会发布端口，实际的端口映射是在`docker-compose.yml`的`ports`部分定义的。

## 如何修改端口配置

如果需要修改端口配置，建议按照以下方式进行：

1. **修改主机映射端口**（推荐）:
   - 在`.env`文件或`docker-compose.yml`中修改端口映射
   - 示例：`"${FRONTEND_PORT:-3000}:80"` 改为 `"${FRONTEND_PORT:-8080}:80"`

2. **修改容器内部端口**（不推荐）:
   - 这需要修改Nginx配置文件和Dockerfile
   - 可能会导致与标准配置不一致，增加维护复杂性
